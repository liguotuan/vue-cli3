{"remainingRequest":"/Users/lishentuan/liguotuan/vue-cli3/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lishentuan/liguotuan/vue-cli3/src/components/pdf/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lishentuan/liguotuan/vue-cli3/src/components/pdf/index.vue","mtime":1597658877495},{"path":"/Users/lishentuan/liguotuan/vue-cli3/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lishentuan/liguotuan/vue-cli3/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/lishentuan/liguotuan/vue-cli3/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lishentuan/liguotuan/vue-cli3/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBQREZKUyBmcm9tICJwZGZqcy1kaXN0IjsKaW1wb3J0IHsgamlhbmxpIH0gZnJvbSAiLi4vdnVlLXBkZi9qaWFubGkiOwovLyBpbXBvcnQgeyBqaWFubGkgfSBmcm9tICIuL2ppYW5saSI7CmV4cG9ydCBkZWZhdWx0IHsKICBwcm9wczogewogICAgcGRmV2lkdGg6IHsKICAgICAgdHlwZTogTnVtYmVyLAogICAgICBkZWZhdWx0OiAzNzUsCiAgICB9LAogICAgcGRmSGVpZ2h0OiB7CiAgICAgIHR5cGU6IE51bWJlciwKICAgICAgZGVmYXVsdDogNjAwLAogICAgfSwKICAgIHBkZlVybDogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIGRlZmF1dDogIiIsCiAgICB9LAogICAgY291bnREb3duOiB7CiAgICAgIHR5cGU6IE51bWJlciwKICAgICAgZGVmYXVsdDogMzAsCiAgICB9LAogICAgcGRmVGl0bGU6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICBkZWZhdXQ6ICIiLAogICAgfSwKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBwZGZEb2M6ICIiLAogICAgICBjb3VudDogMCwKICAgICAgYnV0dG9uQWN0aXZlOiB7CiAgICAgICAgImJhY2tncm91bmQiOiAnI2VhMmMxZCcsCiAgICAgICAgJ2JvcmRlcic6ICdyZWQgc29saWQgMXB4JwogICAgICB9LAogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGluaXQoKSB7CiAgICAgIGNvbnN0IF90aGlzID0gdGhpczsKICAgICAgbGV0IHBkZkJhc2U2NERhdGEgPSBhdG9iKGppYW5saSk7CiAgICAgIC8vIGNvbnN0IHBkZiA9IFBERkpTLmdldERvY3VtZW50KHsgZGF0YTogdGhpcy5wZGZEb2MgfSk7CiAgICAgIFBERkpTLmdldERvY3VtZW50KHsgZGF0YTogcGRmQmFzZTY0RGF0YSB9KS50aGVuKChyZXMpID0+IHsKICAgICAgICBjb25zb2xlLmxvZyhyZXMpOwogICAgICAgIF90aGlzLnBkZkRvYyA9IHJlczsKICAgICAgICBfdGhpcy5jb3VudCA9IHJlcy5udW1QYWdlczsKICAgICAgICBfdGhpcy4kbmV4dFRpY2soKCkgPT4gewogICAgICAgICAgX3RoaXMucmVuZGVyUGFnZSgxKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgLy8g5riy5p+TcGRmCiAgICByZW5kZXJQYWdlKG51bSkgewogICAgICBjb25zdCBfdGhpcyA9IHRoaXM7CiAgICAgIF90aGlzLnBkZkRvYy5nZXRQYWdlKG51bSkudGhlbigocGFnZSkgPT4gewogICAgICAgIGxldCBjYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY2FudmFzUGRmIiArIG51bSk7CiAgICAgICAgbGV0IGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCIyZCIpOwogICAgICAgIGxldCBkcHIgPSB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyB8fCAxOwogICAgICAgIGxldCBic3IgPQogICAgICAgICAgY3R4LndlYmtpdEJhY2tpbmdTdG9yZVBpeGVsUmF0aW8gfHwKICAgICAgICAgIGN0eC5tb3pCYWNraW5nU3RvcmVQaXhlbFJhdGlvIHx8CiAgICAgICAgICBjdHgubXNCYWNraW5nU3RvcmVQaXhlbFJhdGlvIHx8CiAgICAgICAgICBjdHgub0JhY2tpbmdTdG9yZVBpeGVsUmF0aW8gfHwKICAgICAgICAgIGN0eC5iYWNraW5nU3RvcmVQaXhlbFJhdGlvIHx8CiAgICAgICAgICAxOwogICAgICAgIGxldCByYXRpbyA9IGRwciAvIGJzcjsKICAgICAgICBjb25zb2xlLmxvZygic2NyZWVuLmF2YWlsV2lkdGgiLCBzY3JlZW4uYXZhaWxXaWR0aCk7CiAgICAgICAgbGV0IHNjYWxlID0gX3RoaXMucGRmV2lkdGggLyBwYWdlLmdldFZpZXdwb3J0KDEpLndpZHRoOwogICAgICAgIGNvbnNvbGUubG9nKCJzY2FsZSIsIHNjYWxlKTsKICAgICAgICBsZXQgdmlld3BvcnQgPSBwYWdlLmdldFZpZXdwb3J0KHNjYWxlKTsKICAgICAgICBjYW52YXMud2lkdGggPSB2aWV3cG9ydC53aWR0aCAqIHJhdGlvOwogICAgICAgIGNhbnZhcy5oZWlnaHQgPSB2aWV3cG9ydC5oZWlnaHQgKiByYXRpbzsKICAgICAgICBjYW52YXMuc3R5bGUud2lkdGggPSB2aWV3cG9ydC53aWR0aCArICJweCI7CiAgICAgICAgY2FudmFzLnN0eWxlLmhlaWdodCA9IHZpZXdwb3J0LmhlaWdodCArICJweCI7CiAgICAgICAgY3R4LnNldFRyYW5zZm9ybShyYXRpbywgMCwgMCwgcmF0aW8sIDAsIDApOwogICAgICAgIGxldCByZW5kZXJDb250ZXh0ID0gewogICAgICAgICAgY2FudmFzQ29udGV4dDogY3R4LAogICAgICAgICAgdmlld3BvcnQ6IHZpZXdwb3J0LAogICAgICAgIH07CiAgICAgICAgcGFnZS5yZW5kZXIocmVuZGVyQ29udGV4dCk7CgogICAgICAgIF90aGlzLnBhZ2VIZWlnaHQgPSB2aWV3cG9ydC5oZWlnaHQ7CiAgICAgICAgaWYgKF90aGlzLmNvdW50ID4gbnVtKSB7CiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgX3RoaXMucmVuZGVyUGFnZShudW0gKyAxKTsKICAgICAgICAgIH0sIDUwMCk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5pbml0KCk7CiAgfSwKfTsK"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;AAWA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/pdf","sourcesContent":["<template>\n  <div class=\"pdf\" :style=\"{'width': pdfWidth + 'px', 'height': pdfHeight + 'px'}\">\n    <div class=\"pdf-title\" v-if=\"pdfTitle\">{{pdfTitle}}</div>\n    <div class=\"pdf-content\">\n      <canvas :id=\"'canvasPdf'+page\" v-for=\"page in count\" :key=\"page\"></canvas>\n    </div>\n    <button class=\"bottomBtn\" :style=\"buttonActive\">确定</button>\n  </div>\n</template>\n\n<script>\nimport PDFJS from \"pdfjs-dist\";\nimport { jianli } from \"../vue-pdf/jianli\";\n// import { jianli } from \"./jianli\";\nexport default {\n  props: {\n    pdfWidth: {\n      type: Number,\n      default: 375,\n    },\n    pdfHeight: {\n      type: Number,\n      default: 600,\n    },\n    pdfUrl: {\n      type: String,\n      defaut: \"\",\n    },\n    countDown: {\n      type: Number,\n      default: 30,\n    },\n    pdfTitle: {\n      type: String,\n      defaut: \"\",\n    },\n  },\n  data() {\n    return {\n      pdfDoc: \"\",\n      count: 0,\n      buttonActive: {\n        \"background\": '#ea2c1d',\n        'border': 'red solid 1px'\n      },\n    };\n  },\n  methods: {\n    init() {\n      const _this = this;\n      let pdfBase64Data = atob(jianli);\n      // const pdf = PDFJS.getDocument({ data: this.pdfDoc });\n      PDFJS.getDocument({ data: pdfBase64Data }).then((res) => {\n        console.log(res);\n        _this.pdfDoc = res;\n        _this.count = res.numPages;\n        _this.$nextTick(() => {\n          _this.renderPage(1);\n        });\n      });\n    },\n    // 渲染pdf\n    renderPage(num) {\n      const _this = this;\n      _this.pdfDoc.getPage(num).then((page) => {\n        let canvas = document.getElementById(\"canvasPdf\" + num);\n        let ctx = canvas.getContext(\"2d\");\n        let dpr = window.devicePixelRatio || 1;\n        let bsr =\n          ctx.webkitBackingStorePixelRatio ||\n          ctx.mozBackingStorePixelRatio ||\n          ctx.msBackingStorePixelRatio ||\n          ctx.oBackingStorePixelRatio ||\n          ctx.backingStorePixelRatio ||\n          1;\n        let ratio = dpr / bsr;\n        console.log(\"screen.availWidth\", screen.availWidth);\n        let scale = _this.pdfWidth / page.getViewport(1).width;\n        console.log(\"scale\", scale);\n        let viewport = page.getViewport(scale);\n        canvas.width = viewport.width * ratio;\n        canvas.height = viewport.height * ratio;\n        canvas.style.width = viewport.width + \"px\";\n        canvas.style.height = viewport.height + \"px\";\n        ctx.setTransform(ratio, 0, 0, ratio, 0, 0);\n        let renderContext = {\n          canvasContext: ctx,\n          viewport: viewport,\n        };\n        page.render(renderContext);\n\n        _this.pageHeight = viewport.height;\n        if (_this.count > num) {\n          setTimeout(() => {\n            _this.renderPage(num + 1);\n          }, 500);\n        }\n      });\n    },\n  },\n  created() {\n    this.init();\n  },\n};\n</script>\n\n<style scoped>\n.pdf {\n  overflow-y: scroll;\n}\n.pdf-title {\n  margin: 10px 0;\n  text-align: center;\n}\n.pdf-content {\n  display: flex;\n  flex-direction: column;\n}\n.bottomBtn {\n  width: 80%;\n  height: 45px;\n  position: relative;\n  left: 50%;\n  transform: translateX(-50%);\n  color: white;\n}\n</style>"]}]}