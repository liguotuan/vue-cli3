{"remainingRequest":"/Users/lishentuan/vue-cli3-admin/node_modules/babel-loader/lib/index.js!/Users/lishentuan/vue-cli3-admin/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/lishentuan/vue-cli3-admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lishentuan/vue-cli3-admin/src/components/pdf/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lishentuan/vue-cli3-admin/src/components/pdf/index.vue","mtime":1613641208311},{"path":"/Users/lishentuan/vue-cli3-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lishentuan/vue-cli3-admin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/lishentuan/vue-cli3-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lishentuan/vue-cli3-admin/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubnVtYmVyLmNvbnN0cnVjdG9yIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IFBERkpTIGZyb20gInBkZmpzLWRpc3QiOwppbXBvcnQgeyBiYXNlRGF0YSB9IGZyb20gIi4vYmFzZTY0RGF0YSI7IC8vIGltcG9ydCB7IGppYW5saSB9IGZyb20gIi4uL3Z1ZS1wZGYvamlhbmxpIjsKCmV4cG9ydCBkZWZhdWx0IHsKICBwcm9wczogewogICAgLy8gUERG5YaF5a655a69CiAgICBwZGZXaWR0aDogewogICAgICB0eXBlOiBOdW1iZXIsCiAgICAgIGRlZmF1bHQ6IDAKICAgIH0sCiAgICAvLyBQREblhoXlrrnpq5gKICAgIHBkZkhlaWdodDogewogICAgICB0eXBlOiBOdW1iZXIsCiAgICAgIGRlZmF1bHQ6IDAKICAgIH0sCiAgICAvLyDmmK/lkKbpnIDopoHmjInpkq4KICAgIGlzTmVlZEJ1dHRvbjogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICBkZWZhdWx0OiBmYWxzZQogICAgfSwKICAgIC8vIOaYr+WQpuaMiemSrumcgOimgeWAkuiuoeaXtgogICAgaXNDb3VudERvd246IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgZGVmYXVsdDogZmFsc2UKICAgIH0sCiAgICAvLyDlgJLorqHml7YKICAgIGNvdW50RG93bjogewogICAgICB0eXBlOiBOdW1iZXIsCiAgICAgIGRlZmF1bHQ6IDMwCiAgICB9LAogICAgcGRmVXJsOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXV0OiAiIgogICAgfSwKICAgIHBkZlRpdGxlOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXV0OiAiIgogICAgfQogIH0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHBkZkRvYzogIiIsCiAgICAgIGNvdW50OiAwLAogICAgICBidXR0b25BY3RpdmU6IHsKICAgICAgICBiYWNrZ3JvdW5kOiAiI2VhMmMxZCIsCiAgICAgICAgY29sb3I6ICJ3aGl0ZSIKICAgICAgfSwKICAgICAgYnV0dG9uRGlzYWJsZWQ6IHsKICAgICAgICBiYWNrZ3JvdW5kOiAiI0QzRDNEMyIsCiAgICAgICAgY29sb3I6ICIjNjk2OTY5IgogICAgICB9CiAgICB9OwogIH0sCiAgd2F0Y2g6IHsKICAgIGNvdW50RG93bjogZnVuY3Rpb24gY291bnREb3duKHZhbCkgewogICAgICBpZiAodmFsID09IDApIHsKICAgICAgICBjbGVhckludGVydmFsKHRoaXMuc2V0SW50ZXJ2YWxJRCk7CiAgICAgICAgdGhpcy5jb3VudERvd24gPSAiIjsKICAgICAgfQogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgaW5pdDogZnVuY3Rpb24gaW5pdCgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIHBkZkJhc2U2NERhdGEgPSBhdG9iKGJhc2VEYXRhKTsKICAgICAgUERGSlMuZ2V0RG9jdW1lbnQoewogICAgICAgIGRhdGE6IHBkZkJhc2U2NERhdGEKICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgX3RoaXMyLnNldEludGVydmFsSUQgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpcy5jb3VudERvd24tLTsKICAgICAgICB9LCAxMDAwKTsKICAgICAgICBfdGhpcy5wZGZEb2MgPSByZXM7CiAgICAgICAgX3RoaXMuY291bnQgPSByZXMubnVtUGFnZXM7CgogICAgICAgIF90aGlzLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpcy5yZW5kZXJQYWdlKDEpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICAvLyDmuLLmn5NwZGYKICAgIHJlbmRlclBhZ2U6IGZ1bmN0aW9uIHJlbmRlclBhZ2UobnVtKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIF90aGlzLnBkZkRvYy5nZXRQYWdlKG51bSkudGhlbihmdW5jdGlvbiAocGFnZSkgewogICAgICAgIHZhciBjYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY2FudmFzUGRmIiArIG51bSk7CiAgICAgICAgdmFyIGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCIyZCIpOwogICAgICAgIHZhciBkcHIgPSB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyB8fCAxOwogICAgICAgIHZhciBic3IgPSBjdHgud2Via2l0QmFja2luZ1N0b3JlUGl4ZWxSYXRpbyB8fCBjdHgubW96QmFja2luZ1N0b3JlUGl4ZWxSYXRpbyB8fCBjdHgubXNCYWNraW5nU3RvcmVQaXhlbFJhdGlvIHx8IGN0eC5vQmFja2luZ1N0b3JlUGl4ZWxSYXRpbyB8fCBjdHguYmFja2luZ1N0b3JlUGl4ZWxSYXRpbyB8fCAxOwogICAgICAgIHZhciByYXRpbyA9IGRwciAvIGJzcjsKICAgICAgICBjb25zb2xlLmxvZygic2NyZWVuLmF2YWlsV2lkdGgiLCBzY3JlZW4uYXZhaWxXaWR0aCk7CiAgICAgICAgdmFyIHNjYWxlID0gX3RoaXMucGRmV2lkdGggLyBwYWdlLmdldFZpZXdwb3J0KDEpLndpZHRoOwogICAgICAgIGNvbnNvbGUubG9nKCJzY2FsZSIsIHNjYWxlKTsKICAgICAgICB2YXIgdmlld3BvcnQgPSBwYWdlLmdldFZpZXdwb3J0KHNjYWxlKTsKICAgICAgICBjYW52YXMud2lkdGggPSB2aWV3cG9ydC53aWR0aCAqIHJhdGlvOwogICAgICAgIGNhbnZhcy5oZWlnaHQgPSB2aWV3cG9ydC5oZWlnaHQgKiByYXRpbzsKICAgICAgICBjYW52YXMuc3R5bGUud2lkdGggPSB2aWV3cG9ydC53aWR0aCArICJweCI7CiAgICAgICAgY2FudmFzLnN0eWxlLmhlaWdodCA9IHZpZXdwb3J0LmhlaWdodCArICJweCI7CiAgICAgICAgY3R4LnNldFRyYW5zZm9ybShyYXRpbywgMCwgMCwgcmF0aW8sIDAsIDApOwogICAgICAgIHZhciByZW5kZXJDb250ZXh0ID0gewogICAgICAgICAgY2FudmFzQ29udGV4dDogY3R4LAogICAgICAgICAgdmlld3BvcnQ6IHZpZXdwb3J0CiAgICAgICAgfTsKICAgICAgICBwYWdlLnJlbmRlcihyZW5kZXJDb250ZXh0KTsKICAgICAgICBfdGhpcy5wYWdlSGVpZ2h0ID0gdmlld3BvcnQuaGVpZ2h0OwoKICAgICAgICBpZiAoX3RoaXMuY291bnQgPiBudW0pIHsKICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICBfdGhpcy5yZW5kZXJQYWdlKG51bSArIDEpOwogICAgICAgICAgfSwgNTAwKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgX3RoaXMzLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7fSk7CgogICAgICAgICAgY29uc29sZS5sb2coZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImNhbnZhcyIpKTsKCiAgICAgICAgICBfdGhpczMuJGZvcmNlVXBkYXRlKCk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBzdWJtaXQ6IGZ1bmN0aW9uIHN1Ym1pdChmbGFnKSB7CiAgICAgIGlmIChmbGFnKSB7CiAgICAgICAgdGhpcy4kZW1pdCgib24tY2xpY2siLCB0cnVlKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAodGhpcy5jb3VudERvd24gPiAwKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuJGVtaXQoIm9uLWNsaWNrIiwgdHJ1ZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdGhpcy5pbml0KCk7CiAgfQp9Ow=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"pdf\" :style=\"{'width': pdfWidth + 'px', 'height': pdfHeight + 'px'}\">\n    <div class=\"pdf-title\" v-if=\"pdfTitle\">{{pdfTitle}}</div>\n    <div class=\"pdf-content\">\n      <canvas :id=\"'canvasPdf'+page\" v-for=\"page in count\" :key=\"page\"></canvas>\n    </div>\n    <div v-if=\"isNeedButton\">\n      <div v-if=\"!isCountDown\" class=\"bottomBtn\" :style=\"buttonActive\" @click=\"submit(true)\">确定</div>\n      <div\n        @click=\"submit(false)\"\n        v-if=\"isCountDown\"\n        class=\"bottomBtn\"\n        :style=\"countDown == 0 ? buttonActive : buttonDisabled\"\n      >确定{{` ${countDown}`}}</div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport PDFJS from \"pdfjs-dist\";\nimport { baseData } from \"./base64Data\";\n// import { jianli } from \"../vue-pdf/jianli\";\nexport default {\n  props: {\n    // PDF内容宽\n    pdfWidth: {\n      type: Number,\n      default: 0,\n    },\n    // PDF内容高\n    pdfHeight: {\n      type: Number,\n      default: 0,\n    },\n    // 是否需要按钮\n    isNeedButton: {\n      type: Boolean,\n      default: false,\n    },\n    // 是否按钮需要倒计时\n    isCountDown: {\n      type: Boolean,\n      default: false,\n    },\n    // 倒计时\n    countDown: {\n      type: Number,\n      default: 30,\n    },\n    pdfUrl: {\n      type: String,\n      defaut: \"\",\n    },\n    pdfTitle: {\n      type: String,\n      defaut: \"\",\n    },\n  },\n  data() {\n    return {\n      pdfDoc: \"\",\n      count: 0,\n      buttonActive: {\n        background: \"#ea2c1d\",\n        color: \"white\",\n      },\n      buttonDisabled: {\n        background: \"#D3D3D3\",\n        color: \"#696969\",\n      },\n    };\n  },\n  watch: {\n    countDown(val) {\n      if (val == 0) {\n        clearInterval(this.setIntervalID);\n        this.countDown = \"\";\n      }\n    },\n  },\n  methods: {\n    init() {\n      const _this = this;\n      let pdfBase64Data = atob(baseData);\n      PDFJS.getDocument({ data: pdfBase64Data }).then((res) => {\n        this.setIntervalID = setInterval(() => {\n          _this.countDown--;\n        }, 1000);\n        _this.pdfDoc = res;\n        _this.count = res.numPages;\n        _this.$nextTick(() => {\n          _this.renderPage(1);\n        });\n      });\n    },\n    // 渲染pdf\n    renderPage(num) {\n      const _this = this;\n      _this.pdfDoc.getPage(num).then((page) => {\n        let canvas = document.getElementById(\"canvasPdf\" + num);\n        let ctx = canvas.getContext(\"2d\");\n        let dpr = window.devicePixelRatio || 1;\n        let bsr =\n          ctx.webkitBackingStorePixelRatio ||\n          ctx.mozBackingStorePixelRatio ||\n          ctx.msBackingStorePixelRatio ||\n          ctx.oBackingStorePixelRatio ||\n          ctx.backingStorePixelRatio ||\n          1;\n        let ratio = dpr / bsr;\n        console.log(\"screen.availWidth\", screen.availWidth);\n        let scale = _this.pdfWidth / page.getViewport(1).width;\n        console.log(\"scale\", scale);\n        let viewport = page.getViewport(scale);\n        canvas.width = viewport.width * ratio;\n        canvas.height = viewport.height * ratio;\n        canvas.style.width = viewport.width + \"px\";\n        canvas.style.height = viewport.height + \"px\";\n        ctx.setTransform(ratio, 0, 0, ratio, 0, 0);\n        let renderContext = {\n          canvasContext: ctx,\n          viewport: viewport,\n        };\n        page.render(renderContext);\n\n        _this.pageHeight = viewport.height;\n        if (_this.count > num) {\n          setTimeout(() => {\n            _this.renderPage(num + 1);\n          }, 500);\n        } else {\n          this.$nextTick(() => {});\n          console.log(document.getElementsByTagName(\"canvas\"));\n          this.$forceUpdate();\n        }\n      });\n    },\n    submit(flag) {\n      if (flag) {\n        this.$emit(\"on-click\", true);\n      } else {\n        if (this.countDown > 0) {\n          return;\n        } else {\n          this.$emit(\"on-click\", true);\n        }\n      }\n    },\n  },\n  created() {\n    this.init();\n  },\n};\n</script>\n\n<style scoped>\n.pdf {\n  overflow-y: scroll;\n}\n.pdf-title {\n  margin: 10px 0;\n  text-align: center;\n}\n.pdf-content {\n  display: flex;\n  flex-direction: column;\n}\n.bottomBtn {\n  width: 80%;\n  height: 45px;\n  margin: 15px 0;\n  position: relative;\n  left: 50%;\n  transform: translateX(-50%);\n  text-align: center;\n  line-height: 45px;\n}\n</style>"],"sourceRoot":"src/components/pdf"}]}